
Starting DINO training !
Epoch: [0/100]  [  0/488]  eta: 14:28:08  loss: 10.786675 (10.786675)  lr: 0.000000 (0.000000)  wd: 0.040000 (0.040000)  time: 106.738518  data: 101.347572  max mem: 21606
Epoch: [0/100]  [ 10/488]  eta: 1:27:04  loss: 10.957416 (10.946371)  lr: 0.000004 (0.000004)  wd: 0.040000 (0.040000)  time: 10.929841  data: 9.941242  max mem: 21932
Epoch: [0/100]  [ 20/488]  eta: 0:53:58  loss: 11.042400 (11.031144)  lr: 0.000008 (0.000008)  wd: 0.040000 (0.040000)  time: 1.928734  data: 1.386754  max mem: 21932
Epoch: [0/100]  [ 30/488]  eta: 0:38:10  loss: 11.170924 (11.085406)  lr: 0.000016 (0.000012)  wd: 0.040000 (0.040000)  time: 1.741293  data: 1.203606  max mem: 21932
Epoch: [0/100]  [ 40/488]  eta: 0:31:23  loss: 11.214411 (11.117973)  lr: 0.000025 (0.000016)  wd: 0.040000 (0.040000)  time: 1.355173  data: 0.895382  max mem: 21932
Epoch: [0/100]  [ 50/488]  eta: 0:26:54  loss: 11.215451 (11.136696)  lr: 0.000033 (0.000020)  wd: 0.040001 (0.040000)  time: 1.647167  data: 1.115263  max mem: 21932
Epoch: [0/100]  [ 60/488]  eta: 0:24:00  loss: 11.210785 (11.148163)  lr: 0.000041 (0.000025)  wd: 0.040001 (0.040000)  time: 1.643416  data: 0.996407  max mem: 21932
Epoch: [0/100]  [ 70/488]  eta: 0:21:07  loss: 11.200139 (11.154664)  lr: 0.000049 (0.000029)  wd: 0.040001 (0.040001)  time: 1.368723  data: 0.767706  max mem: 21932
Epoch: [0/100]  [ 80/488]  eta: 0:19:05  loss: 11.186386 (11.158071)  lr: 0.000057 (0.000033)  wd: 0.040002 (0.040001)  time: 1.109628  data: 0.218755  max mem: 21932
Epoch: [0/100]  [ 90/488]  eta: 0:18:07  loss: 11.176206 (11.159719)  lr: 0.000066 (0.000037)  wd: 0.040002 (0.040001)  time: 1.666949  data: 0.034553  max mem: 21932
Epoch: [0/100]  [100/488]  eta: 0:17:30  loss: 11.171958 (11.160774)  lr: 0.000074 (0.000041)  wd: 0.040003 (0.040001)  time: 2.300125  data: 0.473401  max mem: 21932
Epoch: [0/100]  [110/488]  eta: 0:16:18  loss: 11.169450 (11.161526)  lr: 0.000082 (0.000045)  wd: 0.040004 (0.040002)  time: 1.927480  data: 0.536441  max mem: 21932
Epoch: [0/100]  [120/488]  eta: 0:15:29  loss: 11.168949 (11.162170)  lr: 0.000090 (0.000049)  wd: 0.040005 (0.040002)  time: 1.605874  data: 0.350404  max mem: 21932
Epoch: [0/100]  [130/488]  eta: 0:14:41  loss: 11.170177 (11.162889)  lr: 0.000098 (0.000053)  wd: 0.040005 (0.040002)  time: 1.771263  data: 0.399860  max mem: 21932
Epoch: [0/100]  [140/488]  eta: 0:14:24  loss: 11.172758 (11.163669)  lr: 0.000107 (0.000057)  wd: 0.040006 (0.040002)  time: 2.237713  data: 0.143458  max mem: 21932
Epoch: [0/100]  [150/488]  eta: 0:13:25  loss: 11.175756 (11.164554)  lr: 0.000115 (0.000061)  wd: 0.040007 (0.040003)  time: 1.853663  data: 0.036832  max mem: 21932
Epoch: [0/100]  [160/488]  eta: 0:12:58  loss: 11.177928 (11.165485)  lr: 0.000123 (0.000066)  wd: 0.040008 (0.040003)  time: 1.588272  data: 0.122910  max mem: 21932
Epoch: [0/100]  [170/488]  eta: 0:12:12  loss: 11.179685 (11.166380)  lr: 0.000131 (0.000070)  wd: 0.040010 (0.040004)  time: 1.714092  data: 0.133159  max mem: 21932
Epoch: [0/100]  [180/488]  eta: 0:11:34  loss: 11.181617 (11.167277)  lr: 0.000139 (0.000074)  wd: 0.040011 (0.040004)  time: 1.297671  data: 0.063970  max mem: 21932
Epoch: [0/100]  [190/488]  eta: 0:11:00  loss: 11.183289 (11.168138)  lr: 0.000148 (0.000078)  wd: 0.040012 (0.040005)  time: 1.450587  data: 0.058916  max mem: 21932
Epoch: [0/100]  [200/488]  eta: 0:10:35  loss: 11.184494 (11.168998)  lr: 0.000156 (0.000082)  wd: 0.040013 (0.040005)  time: 1.763181  data: 0.248192  max mem: 21932
Epoch: [0/100]  [210/488]  eta: 0:10:10  loss: 11.185155 (11.169749)  lr: 0.000164 (0.000086)  wd: 0.040015 (0.040005)  time: 2.015746  data: 0.230315  max mem: 21932
Epoch: [0/100]  [220/488]  eta: 0:09:43  loss: 11.185039 (11.170425)  lr: 0.000172 (0.000090)  wd: 0.040016 (0.040006)  time: 1.885331  data: 0.019898  max mem: 21932
Epoch: [0/100]  [230/488]  eta: 0:09:17  loss: 11.185045 (11.171079)  lr: 0.000180 (0.000094)  wd: 0.040018 (0.040007)  time: 1.801561  data: 0.002683  max mem: 21932
Epoch: [0/100]  [240/488]  eta: 0:08:53  loss: 11.184621 (11.171645)  lr: 0.000189 (0.000098)  wd: 0.040020 (0.040007)  time: 1.848203  data: 0.000242  max mem: 21932
Epoch: [0/100]  [250/488]  eta: 0:08:28  loss: 11.183980 (11.172103)  lr: 0.000197 (0.000102)  wd: 0.040021 (0.040008)  time: 1.853179  data: 0.000270  max mem: 21932
Epoch: [0/100]  [260/488]  eta: 0:08:04  loss: 11.183431 (11.172533)  lr: 0.000205 (0.000107)  wd: 0.040023 (0.040008)  time: 1.844367  data: 0.000259  max mem: 21932
Epoch: [0/100]  [270/488]  eta: 0:07:40  loss: 11.182494 (11.172877)  lr: 0.000213 (0.000111)  wd: 0.040025 (0.040009)  time: 1.818957  data: 0.007816  max mem: 21932
Epoch: [0/100]  [280/488]  eta: 0:07:20  loss: 11.180631 (11.173133)  lr: 0.000221 (0.000115)  wd: 0.040027 (0.040010)  time: 1.996514  data: 0.014044  max mem: 21932
Epoch: [0/100]  [290/488]  eta: 0:06:56  loss: 11.179737 (11.173354)  lr: 0.000230 (0.000119)  wd: 0.040029 (0.040010)  time: 1.958388  data: 0.006472  max mem: 21932
Epoch: [0/100]  [300/488]  eta: 0:06:32  loss: 11.178560 (11.173483)  lr: 0.000238 (0.000123)  wd: 0.040031 (0.040011)  time: 1.677544  data: 0.069007  max mem: 21932
Epoch: [0/100]  [310/488]  eta: 0:06:07  loss: 11.176420 (11.173564)  lr: 0.000246 (0.000127)  wd: 0.040034 (0.040012)  time: 1.531078  data: 0.094713  max mem: 21932
Epoch: [0/100]  [320/488]  eta: 0:05:42  loss: 11.174628 (11.173582)  lr: 0.000254 (0.000131)  wd: 0.040036 (0.040013)  time: 1.290331  data: 0.030475  max mem: 21932
Epoch: [0/100]  [330/488]  eta: 0:05:19  loss: 11.173993 (11.173576)  lr: 0.000262 (0.000135)  wd: 0.040038 (0.040014)  time: 1.352640  data: 0.041840  max mem: 21932
Epoch: [0/100]  [340/488]  eta: 0:04:55  loss: 11.173178 (11.173551)  lr: 0.000271 (0.000139)  wd: 0.040041 (0.040014)  time: 1.384155  data: 0.037326  max mem: 21932
Epoch: [0/100]  [350/488]  eta: 0:04:33  loss: 11.172652 (11.173510)  lr: 0.000279 (0.000143)  wd: 0.040043 (0.040015)  time: 1.341608  data: 0.000258  max mem: 21932
Epoch: [0/100]  [360/488]  eta: 0:04:14  loss: 11.171615 (11.173465)  lr: 0.000287 (0.000148)  wd: 0.040046 (0.040016)  time: 1.780347  data: 0.000236  max mem: 21932
Epoch: [0/100]  [370/488]  eta: 0:03:54  loss: 11.171350 (11.173396)  lr: 0.000295 (0.000152)  wd: 0.040048 (0.040017)  time: 2.048810  data: 0.000261  max mem: 21932
Epoch: [0/100]  [380/488]  eta: 0:03:33  loss: 11.171369 (11.173356)  lr: 0.000303 (0.000156)  wd: 0.040051 (0.040018)  time: 1.873287  data: 0.000254  max mem: 21932
Epoch: [0/100]  [390/488]  eta: 0:03:13  loss: 11.171912 (11.173335)  lr: 0.000312 (0.000160)  wd: 0.040054 (0.040019)  time: 1.767973  data: 0.000227  max mem: 21932
Epoch: [0/100]  [400/488]  eta: 0:02:52  loss: 11.172572 (11.173348)  lr: 0.000320 (0.000164)  wd: 0.040057 (0.040020)  time: 1.648000  data: 0.000311  max mem: 21932
Epoch: [0/100]  [410/488]  eta: 0:02:34  loss: 11.174439 (11.173399)  lr: 0.000328 (0.000168)  wd: 0.040060 (0.040021)  time: 1.943853  data: 0.070896  max mem: 21932
Epoch: [0/100]  [420/488]  eta: 0:02:12  loss: 11.176490 (11.173485)  lr: 0.000336 (0.000172)  wd: 0.040063 (0.040022)  time: 1.760607  data: 0.070812  max mem: 21932
Epoch: [0/100]  [430/488]  eta: 0:01:53  loss: 11.177923 (11.173607)  lr: 0.000344 (0.000176)  wd: 0.040066 (0.040023)  time: 1.611380  data: 0.000221  max mem: 21932
Epoch: [0/100]  [440/488]  eta: 0:01:33  loss: 11.179287 (11.173752)  lr: 0.000353 (0.000180)  wd: 0.040069 (0.040024)  time: 1.993928  data: 0.000519  max mem: 21932
Epoch: [0/100]  [450/488]  eta: 0:01:13  loss: 11.181235 (11.173930)  lr: 0.000361 (0.000184)  wd: 0.040072 (0.040025)  time: 1.566917  data: 0.000532  max mem: 21932
Epoch: [0/100]  [460/488]  eta: 0:00:53  loss: 11.181902 (11.174128)  lr: 0.000369 (0.000189)  wd: 0.040076 (0.040026)  time: 1.244939  data: 0.008058  max mem: 21932
Epoch: [0/100]  [470/488]  eta: 0:00:34  loss: 11.183849 (11.174342)  lr: 0.000377 (0.000193)  wd: 0.040079 (0.040027)  time: 1.391076  data: 0.010305  max mem: 21932
Epoch: [0/100]  [480/488]  eta: 0:00:15  loss: 11.184484 (11.174559)  lr: 0.000385 (0.000197)  wd: 0.040082 (0.040029)  time: 1.501631  data: 0.002413  max mem: 21932
Epoch: [0/100]  [487/488]  eta: 0:00:01  loss: 11.184666 (11.174704)  lr: 0.000391 (0.000200)  wd: 0.040085 (0.040030)  time: 1.404052  data: 0.002332  max mem: 21932
Epoch: [0/100] Total time: 0:15:30 (1.906721 s / it)
Averaged stats: loss: 11.184666 (11.174700)  lr: 0.000391 (0.000200)  wd: 0.040085 (0.040030)
submitit ERROR (2024-08-22 19:54:52,178) - Submitted job triggered an exception
submitit ERROR (2024-08-22 19:54:52,178) - Submitted job triggered an exception
Traceback (most recent call last):
  File "/home/x_shuji/.conda/envs/data4robotics/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/x_shuji/.conda/envs/data4robotics/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/x_shuji/.conda/envs/data4robotics/lib/python3.9/site-packages/submitit/core/_submit.py", line 11, in <module>
    submitit_main()
  File "/home/x_shuji/.conda/envs/data4robotics/lib/python3.9/site-packages/submitit/core/submission.py", line 76, in submitit_main
    process_job(args.folder)
  File "/home/x_shuji/.conda/envs/data4robotics/lib/python3.9/site-packages/submitit/core/submission.py", line 69, in process_job
    raise error
  File "/home/x_shuji/.conda/envs/data4robotics/lib/python3.9/site-packages/submitit/core/submission.py", line 55, in process_job
    result = delayed.result()
  File "/home/x_shuji/.conda/envs/data4robotics/lib/python3.9/site-packages/submitit/core/utils.py", line 133, in result
    self._result = self.function(*self.args, **self.kwargs)
  File "/home/x_shuji/dino/run_with_submitit.py", line 77, in __call__
    main_dino.train_dino(self.args)
  File "/home/x_shuji/dino/main_dino.py", line 290, in train_dino
    train_stats = train_one_epoch(student, teacher, teacher_without_ddp, dino_loss,
  File "/home/x_shuji/dino/main_dino.py", line 378, in train_one_epoch
    if wandb is not None and misc.is_main_process():
NameError: name 'misc' is not defined